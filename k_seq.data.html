

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>k_seq.data: data preprocessing &mdash; k-seq 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="k_seq.model: kinetics and pool models" href="k_seq.model.html" />
    <link rel="prev" title="k-seq package" href="k-seq_package.html" />
    <link href="_static/update_theme.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> k-seq
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="k-seq_package.html"><code class="docutils literal notranslate"><span class="pre">k-seq</span></code> package</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">k_seq.data</span></code>: data preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-k_seq.data.preprocess">k_seq.data.preprocess</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-k_seq.data.seq_data">k_seq.data.seq_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#k-seq-data-seq-data-analyzer">k_seq.data.seq_data_analyzer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#k-seq-data-filters-module">k_seq.data.filters module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-k_seq.data.grouper">k_seq.data.grouper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#k-seq-data-variant-pool-module">k_seq.data.variant_pool module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-k_seq.data.simu">k_seq.data.simu module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#k-seq-data-visualzation-module">k_seq.data.visualzation module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="k_seq.model.html"><code class="docutils literal notranslate"><span class="pre">k_seq.model</span></code>: kinetics and pool models</a></li>
<li class="toctree-l2"><a class="reference internal" href="k_seq.estimate.html"><code class="docutils literal notranslate"><span class="pre">k_seq.estimate</span></code>: least squares fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="k_seq.utility.html"><code class="docutils literal notranslate"><span class="pre">k_seq.utility</span></code>: miscellaneous utility functions</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">k-seq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="k-seq_package.html"><code class="docutils literal notranslate"><span class="pre">k-seq</span></code> package</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">k_seq.data</span></code>: data preprocessing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/k_seq.data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-k_seq.data">
<span id="k-seq-data-data-preprocessing"></span><h1><code class="docutils literal notranslate"><span class="pre">k_seq.data</span></code>: data preprocessing<a class="headerlink" href="#module-k_seq.data" title="Permalink to this headline">¶</a></h1>
<p>Modules for data handling, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">preprocessing</span></code>: core module in data pre-processing from count file to <em>SequenceSeq</em> for estimator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">io</span></code>: module contains utility function for read, write and convert different file formats</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis</span></code>: module contains functions for extra analysis for sequencing samples or reads to sample investigation
and sample pipeline quality control</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simu</span></code>: module contains codes to generate simulated data used in analysis in paper (TODO: add paper citation)</p></li>
</ul>
<dl class="py function">
<dt id="k_seq.data.axis_mapper">
<code class="sig-prename descclassname">k_seq.data.</code><code class="sig-name descname">axis_mapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">axis</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.axis_mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Map the name of data table axis to axis number
axis 0: seq, sequence, sequences
axis 1: sample, observation, obs</p>
</dd></dl>

<div class="section" id="module-k_seq.data.preprocess">
<span id="k-seq-data-preprocess"></span><h2>k_seq.data.preprocess<a class="headerlink" href="#module-k_seq.data.preprocess" title="Permalink to this headline">¶</a></h2>
<p>This module contains following preprocessing function for sequencing data:</p>
<p>1. Preprocessing DNA sequencing results from fastq.gz files using EasyDIVER pipeline
(<a class="reference external" href="https://github.com/ichen-lab-ucsb/EasyDIVER">https://github.com/ichen-lab-ucsb/EasyDIVER</a>), including joining paired-end reads, trimming primers,
pooling same sample in different lanes, and deduplicate to generate count files of unique sequences.</p>
<ol class="arabic simple" start="2">
<li><p>Parse count files and load as a <code class="docutils literal notranslate"><span class="pre">SeqTable</span></code> object</p></li>
</ol>
<dl class="py function">
<dt id="k_seq.data.preprocess.fastq_to_count">
<code class="sig-prename descclassname">k_seq.data.preprocess.</code><code class="sig-name descname">fastq_to_count</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fastq_root</span></em>, <em class="sig-param"><span class="n">output_path</span><span class="o">=</span><span class="default_value">'pipeline-output'</span></em>, <em class="sig-param"><span class="n">threads</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">forward_primer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reverse_primer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pandas_abs_match</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">join_first</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.preprocess.fastq_to_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <cite>fastq_to_count.sh</cite> subprocess for raw reads joining, pooling, and de-duplicating using
the EasyDIVER pipeline (<a class="reference external" href="https://github.com/ichen-lab-ucsb/EasyDIVER">https://github.com/ichen-lab-ucsb/EasyDIVER</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fastq_root</strong> (<em>path</em>) – path to the root folder contains paired-end raw FASTQ.gz files</p></li>
<li><p><strong>output_path</strong> (<em>path</em>) – path to save output. By default it saves to ‘pipeline-output’ folder</p></li>
<li><p><strong>threads</strong> (<em>int</em>) – number of threads to run pandaSeq for joining. By default it uses all CPUs</p></li>
<li><p><strong>forward_primer</strong> (<em>str</em>) – specify the forward primer for pandaSeq joining and trimming</p></li>
<li><p><strong>reverse_primer</strong> (<em>str</em>) – specify the reverse primer for pandaSeq joining and trimming</p></li>
<li><p><strong>pandas_abs_match</strong> (<em>bool</em>) – if enforce absolute matching in pandaSeq joining. Default True.</p></li>
<li><p><strong>join_first</strong> (<em>bool</em>) – if join before trimming in pandaSeq. Suitable for heavily overlapped paired-end reads.
Default True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>TODO: add an example</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.preprocess.load_Seqtable_from_count_files">
<code class="sig-prename descclassname">k_seq.data.preprocess.</code><code class="sig-name descname">load_Seqtable_from_count_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">count_files</span></em>, <em class="sig-param"><span class="n">file_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pattern_filter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">black_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name_template</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sort_by</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_unit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">input_sample_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sample_metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">note</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dry_run</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.preprocess.load_Seqtable_from_count_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <code class="docutils literal notranslate"><span class="pre">SeqData</span></code> instance from count files.</p>
<p>Multiple sources of count files are supported, indicate in count_files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>count_files</strong> (<em>str</em><em>, or </em><em>list of dict</em>) – root directory to search for count files. To load multiple sources, provide a
list of dict as keyword arguments in the format of
[{‘count_files’: path/to/count/files (required), ‘name_template’: string for name template, ‘pattern_filter’: string
for pattern filter, ‘file_list’: list of file to load, ‘black_list’: list of files to exclude}]</p></li>
<li><p><strong>file_list</strong> (<em>list of str</em>) – optional, only includes the count files with names in the file_list</p></li>
<li><p><strong>pattern_filter</strong> (<em>str</em>) – optional, filter file names based on this pattern, wildcards <code class="docutils literal notranslate"><span class="pre">*/?</span></code> are allowed</p></li>
<li><p><strong>black_list</strong> (<em>list of str</em>) – optional, file names included in black_list will be excluded</p></li>
<li><p><strong>name_template</strong> (<em>str</em>) – naming convention to extract metadata. Use <code class="docutils literal notranslate"><span class="pre">[...]</span></code> to include the region of sample_name,
use <code class="docutils literal notranslate"><span class="pre">{domain_name[,</span> <span class="pre">int/float]}</span></code> to indicate region of domain to extract as metadata, including
<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code> will convert the domain value to int/float in applicable, otherwise, string</p></li>
<li><p><strong>sort_by</strong> (<em>str</em>) – sort the order of samples based on given domain</p></li>
<li><p><strong>dry_run</strong> (<em>bool</em>) – only return the parsed count file names and metadata without actual reading in data</p></li>
<li><p><strong>x_values</strong> (<em>list-like</em><em>, or </em><em>dict</em>) – optional. value for controlled variables. If list-like, should have same length and order as samples; if dict, should have sample names as key</p></li>
<li><p><strong>x_unit</strong> (<em>str</em>) – optional. Unit for controlled variable. e.g. ‘uM’</p></li>
<li><p><strong>input_sample_name</strong> (<em>list of str</em>) – optional. Indicate input samples (unreacted)</p></li>
<li><p><strong>sample_metadata</strong> (<em>dict of objects</em>) – optional. Extra sample metadata</p></li>
<li><p><strong>note</strong> (<em>str</em>) – Note for dataset/seq_table</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Example on metadata extraction from pattern:
&gt;&gt;&gt; metadata = extract_metadata(</p>
<blockquote>
<div><blockquote>
<div><p>sample_name = “R4B-1250A_S16_counts.txt”
template = “R4[{exp_rep}-{concentration, float}{seq_rep}_S{id, int}]_counts.txt”</p>
</div></blockquote>
<p>)</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span>
<span class="go">{</span>
<span class="go">    &#39;name&#39;: &#39;B-1250A_S16&#39;,</span>
<span class="go">    &#39;exp_rep&#39;: &#39;B&#39;,</span>
<span class="go">    &#39;concentration&#39;: 1250.0,</span>
<span class="go">    &#39;seq_rep&#39;: &#39;A&#39;,</span>
<span class="go">    &#39;id&#39;: 16</span>
<span class="go">}</span>
</pre></div>
</div>
<dl>
<dt>Notice: two back-to-back domain can only be parsed if one of them is numeric and one of them is alphabetic, and missing</dt><dd><p>value will raise error</p>
<p>Valid: matching ‘-A1-‘ to ‘-{{sample}}{{replicate, int}}-‘ gives {{ ‘sample’: ‘A’, ‘replicate’: 1}}
Not valid: matching ‘-A-‘ to ‘-{{sample}}{{replicate, int}}-‘ will cause error</p>
<blockquote>
<div><p>matching ‘-AA-‘ to ‘-{{sample}}{{replicate}}-‘ will cause error</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.preprocess.read_count_file">
<code class="sig-prename descclassname">k_seq.data.preprocess.</code><code class="sig-name descname">read_count_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path</span></em>, <em class="sig-param"><span class="n">as_dict</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">number_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.preprocess.read_count_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a single count file generated from EasyDIVER pipeline with format:</p>
<p>Count file format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span> <span class="n">of</span> <span class="n">unique</span> <span class="n">sequences</span> <span class="o">=</span> <span class="mi">2825</span>
<span class="n">total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">molecules</span> <span class="o">=</span> <span class="mi">29348173</span>

<span class="n">AAAAAAAACACCACACA</span>               <span class="mi">2636463</span>
<span class="n">AATATTACATCATCTATC</span>              <span class="mi">86763</span>
<span class="o">...</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – full directory to the count file</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>) – return a dictionary instead of a <cite>pd.DataFrame</cite></p></li>
<li><p><strong>number_only</strong> (<em>bool</em>) – only return number of unique seqs and total counts if True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of unique sequences in the count file
total_counts (int): number of total reads in the count file
sequence_counts (pd.DataFrame): with <code class="docutils literal notranslate"><span class="pre">sequence</span></code> as index and <code class="docutils literal notranslate"><span class="pre">counts</span></code> as the first column</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>unique_seqs (int)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-k_seq.data.seq_data">
<span id="k-seq-data-seq-data"></span><h2>k_seq.data.seq_data<a class="headerlink" href="#module-k_seq.data.seq_data" title="Permalink to this headline">¶</a></h2>
<p>Submodule of <cite>SeqData</cite>, a rich functions class of seq_table for sequencing manipulation This module contains methods
for data pre-processing from count files to <code class="docutils literal notranslate"><span class="pre">CountFile</span></code> for estimator
For absolute quantification, it accepts absolute amount (e.g. measured by qPCR) or reacted fraction
.. todo:: - write output function for each class as JSON file and readable foler</p>
<dl class="py class">
<dt id="k_seq.data.seq_data.SeqData">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.seq_data.</code><code class="sig-name descname">SeqData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">data_unit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sample_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seq_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_note</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_sparse</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">seq_metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sample_metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">grouper</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_unit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">note</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dataset_metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data instance to store k-seq result</p>
<dl class="py attribute">
<dt id="k_seq.data.seq_data.SeqData.seq_table">
<code class="sig-name descname">seq_table</code><a class="headerlink" href="#k_seq.data.seq_data.SeqData.seq_table" title="Permalink to this definition">¶</a></dt>
<dd><p>accessor for tables stored. Including <code class="docutils literal notranslate"><span class="pre">original</span></code> created during initialization.
tables stored should be <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> or <code class="docutils literal notranslate"><span class="pre">SeqTable</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="k_seq.utility.html#k_seq.utility.func_tools.AttrScope" title="k_seq.utility.func_tools.AttrScope">AttrScope</a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt>x_values (list-like, or dict): optional. value for controlled variables. If list-like, should have same length and order as samples; if dict, should have sample names as key</dt><dd><p>x_unit (str): optional. Unit for controlled variable. e.g. ‘uM’
seqs
samples
metadata (AttrScope): accessor for metadata for the dataset, includes</p>
<blockquote>
<div><p>sample (AttrScope): collection of metadata for samples if applicable
seq (AttrScope): collection of metadata for seqs if applicable
created_time (timestamp): datetime of the instance is created
note (str): note for the dataset
other dataset metadata objects could be added</p>
</div></blockquote>
<p>analysis (AttrScope): accessor to some pre-built analyses</p>
</dd>
<dt>Plugins:</dt><dd><p>grouper (GrouperCollection): collection of <code class="docutils literal notranslate"><span class="pre">Grouper</span></code> to slice subtables
spike_in (SpikeInNormalizer): optional. Accessor to the normalizer using spike-in
sample_total (TotalAmountNormalizer): optional. Accessor to the normalizer using total sample amount of seqs
analysis (SeqDataAnalyzer): built-in analysis tools to analyze SeqData object</p>
</dd>
</dl>
<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">data_unit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sample_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seq_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_note</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_sparse</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">seq_metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sample_metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">grouper</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_unit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">note</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dataset_metadata</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <cite>SeqData</cite> object</p>
<p>Args:
data (pd.DataFrame or np.ndarray): 2-D data with indices as sequences and columns as samples. If data is pd.DataFrame, values in index and column will be used as sequences and samples; if data is a 2-D np.ndarray, <cite>sample_list</cite> and <cite>seq_to_fit</cite> are needed with same length and order as data</p>
<blockquote>
<div><p>data_unit (str): The unit of seq_table values, e.g. counts, ng, M. Default counts.
sample_list (list-like): list of samples in the sample, should match the columns in the seq_table data
seq_to_fit:
data_note (str): Note for data seq_table
use_sparse (bool): If store the seq_table value as sparse matrix
seq_metadata (dict of objects): optional. Extra seq metadata
grouper:
x_values (list-like, or dict): optional. value for controlled variables. If list-like, should have same length and order as samples; if dict, should have sample names as key
x_unit (str): optional. Unit for controlled variable. e.g. ‘uM’
note (str): Note for dataset/seq_table
dataset_metadata (dict of objects): optional. Extra dataset metadata</p>
</div></blockquote>
<dl class="simple">
<dt>grouper (dict of list, or dict of dict of list): optional. dict of list (Type 1) of dict of list (Type 2) to</dt><dd><p>create grouper plugin</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.add_grouper">
<code class="sig-name descname">add_grouper</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.add_grouper" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an accessor of GrouperCollection of SeqData if not yet. Add Groupers to the accessor
Initialize a Grouper instance with keyword arguments with a dictionary of:</p>
<blockquote>
<div><dl class="simple">
<dt>group (list or dict): list creates a Type 0 Grouper (single group) and dict creates a Type 1 Grouper</dt><dd><p>(multiple groups)</p>
</dd>
</dl>
<p>target (pd.DataFrame): optional, target table
axis (0 or 1): axis to apply the grouper</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.add_sample_total">
<code class="sig-name descname">add_sample_total</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">total_amounts</span></em>, <em class="sig-param"><span class="n">full_table</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.add_sample_total" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Add TotalAmountNormalizer to quantify sequences with their total amount in each sample</dt><dd><p>as <cite>sample_total</cite></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total_amounts</strong> (<em>dict</em><em> or </em><em>pd.Series</em>) – Total DNA amount for samples measured in experiment</p></li>
<li><p><strong>full_table</strong> (<em>pd.DataFrame</em>) – seq_table where the total amount were measured and normalize to</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – Unit of amount measured</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.add_spike_in">
<code class="sig-name descname">add_spike_in</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">base_table</span></em>, <em class="sig-param"><span class="n">spike_in_seq</span></em>, <em class="sig-param"><span class="n">spike_in_amount</span></em>, <em class="sig-param"><span class="n">radius</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dist_type</span><span class="o">=</span><span class="default_value">'edit'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.add_spike_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Add SpikeInNormalizer to quantify seq amount using spike-in sequence as accessor
<code class="docutils literal notranslate"><span class="pre">spike_in</span></code> to the instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_table</strong> (<em>pd.DataFrame</em>) – base_table includes spike-in sequences to calculate normalization factor</p></li>
<li><p><strong>spike_in_seq</strong> (<em>str</em>) – center sequence for spike-in</p></li>
<li><p><strong>spike_in_amount</strong> (<em>list-like</em><em>, </em><em>dict</em><em>, or </em><em>pd.Series</em>) – added spike_in amount, dict and pd.Series should have key of samples in base_table list-like should have same length as number of samples (cols) in base_table</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – Radius of spike-in peak, seqs less or equal to radius away from center are spike-in seqs</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – unit of spike-in amount</p></li>
<li><p><strong>dist_type</strong> (<em>str</em>) – ‘edit’ or ‘hamming’ as distance measure. Default ‘edit’ to include insertion / deletion</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.from_count_files">
<em class="property">static </em><code class="sig-name descname">from_count_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.from_count_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <code class="docutils literal notranslate"><span class="pre">SeqData</span></code> instance from a folder of count files</p>
<blockquote>
<div><dl>
<dt>Args:</dt><dd><p>count_files (str): root directory to search for count files
file_list (list of str): optional, only includes the count files with names in the file_list
pattern_filter (str): optional, filter file names based on this pattern, wildcards <code class="docutils literal notranslate"><span class="pre">*/?</span></code> are allowed
black_list (list of str): optional, file names included in black_list will be excluded
name_template (str): naming convention to extract metadata. Use <code class="docutils literal notranslate"><span class="pre">[...]</span></code> to include the region of sample_name,</p>
<blockquote>
<div><p>use <code class="docutils literal notranslate"><span class="pre">{domain_name[,</span> <span class="pre">int/float]}</span></code> to indicate region of domain to extract as metadata, including
<code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code> will convert the domain value to int/float in applicable, otherwise, string</p>
</div></blockquote>
<p>sort_by (str): sort the order of samples based on given domain
dry_run (bool): only return the parsed count file names and metadata without actual reading in data</p>
</dd>
</dl>
<p>x_values (list-like, or dict): optional. value for controlled variables. If list-like, should have same length and order as samples; if dict, should have sample names as key
x_unit (str): optional. Unit for controlled variable. e.g. ‘uM’
input_sample_name (list of str): optional. Indicate input samples (unreacted)
sample_metadata (dict of objects): optional. Extra sample metadata
note (str): Note for dataset/seq_table</p>
</div></blockquote>
<p class="rubric">Example</p>
<p>Example on metadata extraction from pattern:
&gt;&gt;&gt; metadata = extract_metadata(</p>
<blockquote>
<div><blockquote>
<div><p>sample_name = “R4B-1250A_S16_counts.txt”
template = “R4[{exp_rep}-{concentration, float}{seq_rep}_S{id, int}]_counts.txt”</p>
</div></blockquote>
<p>)</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span>
<span class="go">{</span>
<span class="go">    &#39;name&#39;: &#39;B-1250A_S16&#39;,</span>
<span class="go">    &#39;exp_rep&#39;: &#39;B&#39;,</span>
<span class="go">    &#39;concentration&#39;: 1250.0,</span>
<span class="go">    &#39;seq_rep&#39;: &#39;A&#39;,</span>
<span class="go">    &#39;id&#39;: 16</span>
<span class="go">}</span>
</pre></div>
</div>
<dl>
<dt>Notice: two back-to-back domain can only be parsed if one of them is numeric and one of them is alphabetic, and missing</dt><dd><p>value will raise error</p>
<p>Valid: matching ‘-A1-‘ to ‘-{{sample}}{{replicate, int}}-‘ gives {{ ‘sample’: ‘A’, ‘replicate’: 1}}
Not valid: matching ‘-A-‘ to ‘-{{sample}}{{replicate, int}}-‘ will cause error</p>
<blockquote>
<div><p>matching ‘-AA-‘ to ‘-{{sample}}{{replicate}}-‘ will cause error</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.from_json">
<code class="sig-name descname">from_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: add json</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.from_pickle">
<em class="property">static </em><code class="sig-name descname">from_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.from_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.samples">
<em class="property">property </em><code class="sig-name descname">samples</code><a class="headerlink" href="#k_seq.data.seq_data.SeqData.samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.seqs">
<em class="property">property </em><code class="sig-name descname">seqs</code><a class="headerlink" href="#k_seq.data.seq_data.SeqData.seqs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.to_json">
<code class="sig-name descname">to_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>More generalized JSON file
TODO: add to_json and from_json</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.to_pickle">
<code class="sig-name descname">to_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqData.update_analysis">
<code class="sig-name descname">update_analysis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqData.update_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Update accessor to SeqDataAnalyzer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="k_seq.data.seq_data.SeqTable">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.seq_data.</code><code class="sig-name descname">SeqTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.core.frame.DataFrame</span></code></p>
<p>Extended <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> with added property and functions for SeqTable</p>
<dl class="simple">
<dt>Additional Attributes:</dt><dd><p>unit (str): unit of entries in this seq_table
note (str): note for this seq_table
samples (pd.Series): samples in the seq_table
seqs (pd.Series): sequences in the seq_table</p>
</dd>
<dt>Additional Methods:</dt><dd><p>about: print a summary of the seq_table
analysis: accessor to SeqTableAnalyzer</p>
</dd>
</dl>
<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize SeqTable instance
Additional kwargs:
unit:</p>
<blockquote>
<div><p>note (str): Note for dataset/seq_table
use_sparse (bool): If store the seq_table value as sparse matrix</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.about">
<code class="sig-name descname">about</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.about" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick view of SeqTable</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.density">
<em class="property">property </em><code class="sig-name descname">density</code><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.density" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.describe">
<code class="sig-name descname">describe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">percentiles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>return major stable statistics</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.filter_axis">
<code class="sig-name descname">filter_axis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filter</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">remove_empty</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.filter_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter seq_table along with one axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<em>callable</em>) – a callable to apply on row/columns and returns a bool value</p></li>
<li><p><strong>axis</strong> (<em>0</em><em> or </em><em>1</em>) – the axis to filter. 0: row, seqs; 1: column, sample</p></li>
<li><p><strong>remove_empty</strong> (<em>bool</em>) – If remove the empty column/rows after filtering</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – if change the seq_table inplace. If False, return a new seq_table</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.samples">
<em class="property">property </em><code class="sig-name descname">samples</code><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.seqs">
<em class="property">property </em><code class="sig-name descname">seqs</code><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.seqs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="k_seq.data.seq_data.SeqTable.update_analysis">
<code class="sig-name descname">update_analysis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.SeqTable.update_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>update the accessor to SeqTableAnalyzer</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data.slice_table">
<code class="sig-prename descclassname">k_seq.data.seq_data.</code><code class="sig-name descname">slice_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">table</span></em>, <em class="sig-param"><span class="n">axis</span></em>, <em class="sig-param"><span class="n">keys</span></em>, <em class="sig-param"><span class="n">remove_empty</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data.slice_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice pd.DataFrame seq_table with a list of key values or filter functions returning True/False along
given axis. Optional to remove all zero entries
:param seq_table: seq_table to slice
:type seq_table: pd.DataFrame
:param keys: list of keys to preserve. If is callable, apply to row/column of seq_table and returns</p>
<blockquote>
<div><p>bool of preserve (True) or discard (False)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>0</em><em> or </em><em>1</em>) – which axis to filter</p></li>
<li><p><strong>remove_empty</strong> (<em>bool</em>) – If remove the empty column/rows after filtering</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="k-seq-data-seq-data-analyzer">
<h2>k_seq.data.seq_data_analyzer<a class="headerlink" href="#k-seq-data-seq-data-analyzer" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-k_seq.data.seq_data_analyzer"></span><dl class="py class">
<dt id="k_seq.data.seq_data_analyzer.SeqDataAnalyzer">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">SeqDataAnalyzer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.SeqDataAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="k_seq.utility.html#k_seq.utility.func_tools.FuncToMethod" title="k_seq.utility.func_tools.FuncToMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_seq.utility.func_tools.FuncToMethod</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="k_seq.data.seq_data_analyzer.SeqTableAnalyzer">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">SeqTableAnalyzer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.SeqTableAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="k_seq.utility.html#k_seq.utility.func_tools.FuncToMethod" title="k_seq.utility.func_tools.FuncToMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_seq.utility.func_tools.FuncToMethod</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.cross_table_compare">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">cross_table_compare</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">base_table</span></em>, <em class="sig-param"><span class="n">compare_table</span></em>, <em class="sig-param"><span class="n">samples</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">color_map</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.cross_table_compare" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.rep_variance_scatter">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">rep_variance_scatter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">grouper</span></em>, <em class="sig-param"><span class="n">xaxis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">subsample</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xlog</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">ylog</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">xlim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_title_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xlabel</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ylabel</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">label_map</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.rep_variance_scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>A scatter plot for measured value variance in replicates for each sequence</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_entropy_scatterplot">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_entropy_scatterplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">black_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">base</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">color_map</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scatter_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_entropy_scatterplot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_info">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize sample info for a SeqData, with info of total amount and spike-in
:returns: A <cite>pd.DataFrame</cite> show the summary for samples</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_overview">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_overview</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_overview" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize sequences for a given seq_table, with info of unique seqs, total amount</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <cite>pd.DataFrame</cite> show the summary for sequences</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_overview_plots">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_overview_plots</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">plot_unique_seq</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_total_counts</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_spike_in_frac</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">color_map</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">black_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">label_mapper</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_overview_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Overview plot(s) of unique seqs, total counts and spike-in fractions in the samples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq_table</strong> (<cite>SeqData</cite>) – sample set to survey</p></li>
<li><p><strong>plot_unique_seq</strong> (<cite>bool</cite>) – plot bar plot for unique sequences if True</p></li>
<li><p><strong>plot_total_counts</strong> (<cite>bool</cite>) – plot bar plot for total counts if True</p></li>
<li><p><strong>plot_spike_in_frac</strong> (<cite>bool</cite>) – plot scatter plot for spike in fraction if True</p></li>
<li><p><strong>color_map</strong> (<em>dict</em>) – {sample_name: color} for all plots</p></li>
<li><p><strong>black_list</strong> (list of <cite>str</cite>) – list of sample name to exlude from the plots</p></li>
<li><p><strong>sep_plot</strong> (<cite>bool</cite>) – plot separate plots for unique sequences, total counts and spike_in fractions if True</p></li>
<li><p><strong>label_mapper</strong> (<em>dict</em><em> or </em><em>callable</em>) – alternative labels for samples</p></li>
<li><p><strong>fig_save_to</strong> (<cite>str</cite>) – save figure to the directory if not None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_rel_abun_hist">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_rel_abun_hist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">black_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_log</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">y_log</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ncol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nrow</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">hist_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_rel_abun_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>todo: add pool counts composition curve for straight forward visualization</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_spike_in_ratio_scatterplot">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_spike_in_ratio_scatterplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">black_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">label_mapper</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scatter_kwargs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_spike_in_ratio_scatterplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Scatter plot of spike in ratio in the pool</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_total_reads_barplot">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_total_reads_barplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">black_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_label</span><span class="o">=</span><span class="default_value">'Total reads'</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">14</span></em>, <em class="sig-param"><span class="n">label_mapper</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">barplot_kwargs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_total_reads_barplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Barplot of total counts (sum over sequences) in each sample</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.sample_unique_seqs_barplot">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">sample_unique_seqs_barplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">black_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_label</span><span class="o">=</span><span class="default_value">'Unique sequences'</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">14</span></em>, <em class="sig-param"><span class="n">label_mapper</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">barplot_kwargs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.sample_unique_seqs_barplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Barplot of unique seqs in each sample</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.seq_length_dist">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">seq_length_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">6, 3</span></em>, <em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">logx</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">logy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hist_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_fig_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.seq_length_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>histogram of length distribution of unique sequences</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.seq_mean_value_detected_samples_scatterplot">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">seq_mean_value_detected_samples_scatterplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">ylabel</span><span class="o">=</span><span class="default_value">'counts'</span></em>, <em class="sig-param"><span class="n">ylog</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">subsample</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'#1F77B4'</span></em>, <em class="sig-param"><span class="n">marker_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">scatter_kwargs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.seq_mean_value_detected_samples_scatterplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Joint plot of of mean value (e.g. count) for a sequence across samples and number of sample it is detected
With one scatter plot (x: number of samples detected, y: mean value)</p>
<blockquote>
<div><p>and two histogram showing the distribution in each dimension</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.seq_overview">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">seq_overview</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.seq_overview" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize sample in seq_table, with info of seq length, sample detected, mean, sd
:returns: A <cite>pd.DataFrame</cite> show the summary for sequences</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.seq_data_analyzer.seq_variance">
<code class="sig-prename descclassname">k_seq.data.seq_data_analyzer.</code><code class="sig-name descname">seq_variance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq_table</span></em>, <em class="sig-param"><span class="n">grouper</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.seq_data_analyzer.seq_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the spread (standard deviation) of sequence abundance across replicates, provided by grouper</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>if single group, returns a pd.DataFrame with columns (‘mean’, ‘sd’)
if multiple groups, returns two pd.DataFrame (mean, sd) with columns of each group</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="k-seq-data-filters-module">
<h2>k_seq.data.filters module<a class="headerlink" href="#k-seq-data-filters-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-k_seq.data.grouper">
<span id="k-seq-data-grouper-module"></span><h2>k_seq.data.grouper module<a class="headerlink" href="#module-k_seq.data.grouper" title="Permalink to this headline">¶</a></h2>
<p>Groupers slice seq_table into groups. E.g. input samples, reacted samples, different concentrations
TODO: simplify code</p>
<dl class="py class">
<dt id="k_seq.data.grouper.Grouper">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.grouper.</code><code class="sig-name descname">Grouper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">group</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.grouper.Grouper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Grouper of samples/sequences</p>
<dl class="simple">
<dt>Two types of grouper accepted:</dt><dd><p>Type 0 (list): initialize with group as list-like. This defines a single set of samples/sequences
Type 1 (dict): initialize with group as dict. This defines a collection of groups of samples/sequences</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="k_seq.data.grouper.Grouper.target">
<code class="sig-name descname">target</code><a class="headerlink" href="#k_seq.data.grouper.Grouper.target" title="Permalink to this definition">¶</a></dt>
<dd><p>accessor for seq_table to group</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="k_seq.data.grouper.Grouper.axis">
<code class="sig-name descname">axis</code><a class="headerlink" href="#k_seq.data.grouper.Grouper.axis" title="Permalink to this definition">¶</a></dt>
<dd><p>axis to apply grouping (0 for index, 1 for columns)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>0 or 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="k_seq.data.grouper.Grouper.group">
<code class="sig-name descname">group</code><a class="headerlink" href="#k_seq.data.grouper.Grouper.group" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary with structure {group_name: group_members}</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list or dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="k_seq.data.grouper.Grouper.type">
<code class="sig-name descname">type</code><a class="headerlink" href="#k_seq.data.grouper.Grouper.type" title="Permalink to this definition">¶</a></dt>
<dd><p>type of the grouper</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>0 or 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.grouper.Grouper.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">group</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.grouper.Grouper.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a Grouper instance
:param group: list creates a Type 0 Grouper (single group) and dict creates a Type 1 Grouper</p>
<blockquote>
<div><p>(multiple groups)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>pd.DataFrame</em>) – optional, target seq_table</p></li>
<li><p><strong>axis</strong> (<em>0</em><em> or </em><em>1</em>) – axis to apply the grouper</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.grouper.Grouper.get_table">
<code class="sig-name descname">get_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">group</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_zero</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.grouper.Grouper.get_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sub-seq_table from target given group</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.grouper.Grouper.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_zero</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.grouper.Grouper.split" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="k_seq.data.grouper.GrouperCollection">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.grouper.</code><code class="sig-name descname">GrouperCollection</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.grouper.GrouperCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="k_seq.utility.html#k_seq.utility.func_tools.AttrScope" title="k_seq.utility.func_tools.AttrScope"><code class="xref py py-class docutils literal notranslate"><span class="pre">k_seq.utility.func_tools.AttrScope</span></code></a></p>
<p>A collection of groupers</p>
<dl class="py method">
<dt id="k_seq.data.grouper.GrouperCollection.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.grouper.GrouperCollection.add" title="Permalink to this definition">¶</a></dt>
<dd><p>add a grouper</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="k_seq.data.grouper.get_group">
<code class="sig-prename descclassname">k_seq.data.grouper.</code><code class="sig-name descname">get_group</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">table</span></em>, <em class="sig-param"><span class="n">group</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">remove_empty</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.grouper.get_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice or split the table based on the group
:param table: target table to group
:type table: pd.DataFrame or SeqTable
:param group: single group or a set of groups
:type group: list-like or dict of list</p>
</dd></dl>

</div>
<div class="section" id="k-seq-data-variant-pool-module">
<h2>k_seq.data.variant_pool module<a class="headerlink" href="#k-seq-data-variant-pool-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-k_seq.data.variant_pool"></span><p>Function for variant pool design</p>
<dl class="py function">
<dt id="k_seq.data.variant_pool.combination">
<code class="sig-prename descclassname">k_seq.data.variant_pool.</code><code class="sig-name descname">combination</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.variant_pool.combination" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="k_seq.data.variant_pool.d_mutant_fraction">
<code class="sig-prename descclassname">k_seq.data.variant_pool.</code><code class="sig-name descname">d_mutant_fraction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">mutation_rate</span></em>, <em class="sig-param"><span class="n">length</span><span class="o">=</span><span class="default_value">21</span></em>, <em class="sig-param"><span class="n">letter_book_size</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.variant_pool.d_mutant_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Relative abundance for a single d-order mutants</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.variant_pool.neighbor_effect_error">
<code class="sig-prename descclassname">k_seq.data.variant_pool.</code><code class="sig-name descname">neighbor_effect_error</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xi</span></em>, <em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">eta</span><span class="o">=</span><span class="default_value">0.09</span></em>, <em class="sig-param"><span class="n">L</span><span class="o">=</span><span class="default_value">21</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.variant_pool.neighbor_effect_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Fraction of reads from neighboring sequences due to sequencing error</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.variant_pool.neighbor_effect_observation">
<code class="sig-prename descclassname">k_seq.data.variant_pool.</code><code class="sig-name descname">neighbor_effect_observation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xi</span></em>, <em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">eta</span><span class="o">=</span><span class="default_value">0.09</span></em>, <em class="sig-param"><span class="n">L</span><span class="o">=</span><span class="default_value">21</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.variant_pool.neighbor_effect_observation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ratio of observed abundance for a d-th order mutant,
considering the neighbor effect under given sequencing error rate (xi)</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.variant_pool.num_of_seq">
<code class="sig-prename descclassname">k_seq.data.variant_pool.</code><code class="sig-name descname">num_of_seq</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">length</span><span class="o">=</span><span class="default_value">21</span></em>, <em class="sig-param"><span class="n">letter_book_size</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.variant_pool.num_of_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Expected number of</p>
</dd></dl>

</div>
<div class="section" id="module-k_seq.data.simu">
<span id="k-seq-data-simu-module"></span><h2>k_seq.data.simu module<a class="headerlink" href="#module-k_seq.data.simu" title="Permalink to this headline">¶</a></h2>
<p>Module contains code to simulate data</p>
<dl class="py class">
<dt id="k_seq.data.simu.DistGenerators">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.simu.</code><code class="sig-name descname">DistGenerators</code><a class="headerlink" href="#k_seq.data.simu.DistGenerators" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A collection of random value generators from commonly used distributions.
<cite>uniq_seq_num</cite> number of independent draw of distribution are returned</p>
<dl class="simple">
<dt>Available distributions:</dt><dd><p>lognormal
uniform
compo_lognormal</p>
</dd>
</dl>
<dl class="py method">
<dt id="k_seq.data.simu.DistGenerators.compo_lognormal">
<em class="property">static </em><code class="sig-name descname">compo_lognormal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">loc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c95</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.DistGenerators.compo_lognormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a pool composition from a log-normal distribution
indicate with <cite>loc</cite> and <cite>scale</cite>, or <cite>c95</cite></p>
<p class="rubric">Example</p>
<p>scale = 0 means an evenly distributed pool with all components have relative abundance 1/uniq_seq_num</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<cite>int</cite>) – uniq_seq_num of the pool</p></li>
<li><p><strong>loc</strong> (<cite>float</cite>) – center of log-normal distribution</p></li>
<li><p><strong>scale</strong> (<cite>float</cite>) – log variance of the distribution</p></li>
<li><p><strong>c95</strong> ([<cite>float</cite>, <cite>float</cite>]) – 95% percentile of log-normal distribution</p></li>
<li><p><strong>seed</strong> – random seed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.simu.DistGenerators.lognormal">
<em class="property">static </em><code class="sig-name descname">lognormal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c95</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.DistGenerators.lognormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from a log-normal distribution
indicate with <cite>loc</cite> and <cite>scale</cite>, or <cite>c95</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<cite>int</cite>) – number of values to draw</p></li>
<li><p><strong>loc</strong> (<cite>float</cite>) – center of log-normal distribution, default 0</p></li>
<li><p><strong>scale</strong> (<cite>float</cite>) – log variance of the distribution, default 0</p></li>
<li><p><strong>c95</strong> ([<cite>float</cite>, <cite>float</cite>]) – 95% percentile of log-normal distribution</p></li>
<li><p><strong>seed</strong> – random seed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a draw from distribution with given uniq_seq_num</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.simu.DistGenerators.uniform">
<em class="property">static </em><code class="sig-name descname">uniform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">low</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">high</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.DistGenerators.uniform" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample from a uniform distribution</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="k_seq.data.simu.PoolParamGenerator">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.simu.</code><code class="sig-name descname">PoolParamGenerator</code><a class="headerlink" href="#k_seq.data.simu.PoolParamGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Functions to generate parameters for a set of sequence in a sequence pool</p>
<dl class="py method">
<dt>
<code class="sig-name descname">- sample_from_iid_dist</code></dt>
<dd></dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">- sample_from_dataframe</code></dt>
<dd></dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pd.DataFrame with columns of parameters and rows of simulated parameter for each sequence</p>
</dd>
</dl>
<dl class="py method">
<dt id="k_seq.data.simu.PoolParamGenerator.sample_from_dataframe">
<em class="property">classmethod </em><code class="sig-name descname">sample_from_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">uniq_seq_num</span></em>, <em class="sig-param"><span class="n">replace</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.PoolParamGenerator.sample_from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate parameter by resampling rows of a given dataframe
:param df: dataframe contains parameters as columns to sample from,</p>
<blockquote>
<div><p>needs to have <cite>p0</cite> as one column for heterogenous pool</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
<p>uniq_seq_num (int): Number of unique sequences from simulation</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.simu.PoolParamGenerator.sample_from_iid_dist">
<em class="property">static </em><code class="sig-name descname">sample_from_iid_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uniq_seq_num</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">param_generators</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.PoolParamGenerator.sample_from_iid_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate the seq parameters from individual draws of distributions
Parameter:</p>
<blockquote>
<div><p>p0: initial fraction for each sequence for uneven pool
depending on the model. e.g. first-order model needs to include k and A</p>
</div></blockquote>
<dl class="simple">
<dt>Accepted parameter input:</dt><dd><ul class="simple">
<li><p>list-like: if uniq_seq_num does not match as expected uniq_seq_num, resample with replacement</p></li>
<li><p>generator: given generator returns a random parameter</p></li>
<li><p>callable: if taking <cite>uniq_seq_num</cite> as an argument, needs to return a uniq_seq_num vector of sampled parameter or a
generator to generate a uniq_seq_num vector; if not taking <cite>uniq_seq_num</cite> as an argument, needs to return single
sample</p></li>
</ul>
</dd>
</dl>
<p>Args:
p0 (list-like, generator, or callable): reserved argument for initial pool composition (fraction)</p>
<blockquote>
<div><p>uniq_seq_num (int): Number of unique sequences from simulation
seed (int): random seed for repeatability
param_generators (kwargs of list-like, generator, or callable): parameter generator depending on the model</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a n_row = uniq_seq_num pd.DataFrame contains generated parameters</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="k_seq.data.simu.SimulationResults">
<em class="property">class </em><code class="sig-prename descclassname">k_seq.data.simu.</code><code class="sig-name descname">SimulationResults</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset_dir</span></em>, <em class="sig-param"><span class="n">result_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.SimulationResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to load simulation result</p>
<dl class="py method">
<dt id="k_seq.data.simu.SimulationResults.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset_dir</span></em>, <em class="sig-param"><span class="n">result_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.SimulationResults.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Survey estimation results
- load fitting results from <cite>result_dir/fit_summary.csv</cite>
- load truth and input count infor from <cite>dataset_dir/truth.csv</cite> and <cite>input_counts</cite></p>
<p>Optional to include:
- input_counts: counts of sequences in the input pool
- mean_counts: mean counts in all samples (input and reacted)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>table of estimated k, A, kA
truth: table of true k, A, p0, ka, and input_counts
seq_list: list of indices of sequences that were able to estimate</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>results</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.simu.SimulationResults.get_est_results">
<code class="sig-name descname">get_est_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param</span></em>, <em class="sig-param"><span class="n">pred_type</span><span class="o">=</span><span class="default_value">'point_est'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.SimulationResults.get_est_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the estimation (pred) and truth of given parameter</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.simu.SimulationResults.get_fold_range">
<code class="sig-name descname">get_fold_range</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.SimulationResults.get_fold_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ratio of 97.5-percentile to 2.5-percentile</p>
</dd></dl>

<dl class="py method">
<dt id="k_seq.data.simu.SimulationResults.get_uncertainty_accuracy">
<code class="sig-name descname">get_uncertainty_accuracy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param</span></em>, <em class="sig-param"><span class="n">pred_type</span><span class="o">=</span><span class="default_value">'bs_ci95'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.SimulationResults.get_uncertainty_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the accuracy of uncertainty estimation if uncertainty range includes the truth</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="k_seq.data.simu.get_pct_gaussian_error">
<code class="sig-prename descclassname">k_seq.data.simu.</code><code class="sig-name descname">get_pct_gaussian_error</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rate</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.get_pct_gaussian_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function to apply Gaussian error proportional to the value</p>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.simu.simulate_counts">
<code class="sig-prename descclassname">k_seq.data.simu.</code><code class="sig-name descname">simulate_counts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uniq_seq_num</span></em>, <em class="sig-param"><span class="n">x_values</span></em>, <em class="sig-param"><span class="n">total_reads</span></em>, <em class="sig-param"><span class="n">p0_generator</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kinetic_model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">count_model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">total_amount_error</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">param_sample_from_df</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">replace</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reps</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">note</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_to</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">param_generators</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.simulate_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate sequencing count dataset given kinetic and count model</p>
<dl>
<dt>Procedure:</dt><dd><ol class="arabic simple">
<li><p>parameter for each unique sequences were sampled from param_sample_from_df and kwargs</p></li>
</ol>
<blockquote>
<div><p>(param_generators). It is an even pool if p0 is not provided. No repeated parameters.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>simulate the reacted amount / fraction of sequences with each controlled variable in x_values</p></li>
<li><p>Simulated counts with given total total_reads were simulated for input pool and reacted pools.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uniq_seq_num</strong> (<em>int</em>) – Number of unique sequences from simulation</p></li>
<li><p><strong>x_values</strong> (<em>list-like</em>) – list of controlled variables in each experiment setup,negative value means it is an initial pool</p></li>
<li><p><strong>total_reads</strong> – </p></li>
<li><p><strong>p0</strong> (<em>list-like</em><em>, </em><em>generator</em><em>, or </em><em>callable</em>) – reserved argument for initial pool composition (fraction)</p></li>
<li><p><strong>kinetic_model</strong> (<em>callable</em>) – model the amount of sequences in reaction given input variables. Default <cite>BYOModel.amount_first_order</cite></p></li>
<li><p><strong>count_model</strong> (<em>callable</em>) – model the sequencing counts w.r.t. total reads and pool composition.Default MultiNomial model.</p></li>
<li><p><strong>param_sample_from_df</strong> (<em>pd.DataFrame</em>) – optional to sample sequences from given table</p></li>
<li><p><strong>weights</strong> (<em>list</em><em> or </em><em>str</em>) – weights/col of weight for sampling from table</p></li>
<li><p><strong>total_amount_error</strong> (<em>float</em><em> or </em><em>callable</em>) – float as the standard deviation for a fixed Gaussian error, or any error function on the DNA amount. Use 0 for no introduced error.</p></li>
<li><p><strong>conv_reps</strong> – </p></li>
<li><p><strong>seed</strong> (<em>int</em>) – random seed for repeatability</p></li>
<li><p><strong>save_to</strong> (<em>str</em>) – optional, path to save the simulation results with x, Y, truth csv file and a pickled SeqData object</p></li>
<li><p><strong>param_generator</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>c, n value for samples
Y (pd.DataFrame): simulated sequence counts for given samples
param_table (pd.DataFrame): seq_table list the parameters for simulated sequences
seq_table (data.SeqData): a SeqData object to stores all the data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>x (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.simu.simulate_on_byo_doped_condition_from_exp_results">
<code class="sig-prename descclassname">k_seq.data.simu.</code><code class="sig-name descname">simulate_on_byo_doped_condition_from_exp_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">fitting_res</span></em>, <em class="sig-param"><span class="n">uniq_seq_num</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">total_reads</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sequencing_depth</span><span class="o">=</span><span class="default_value">40</span></em>, <em class="sig-param"><span class="n">n_input</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">table_name</span><span class="o">=</span><span class="default_value">'original'</span></em>, <em class="sig-param"><span class="n">total_dna_error_rate</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">23</span></em>, <em class="sig-param"><span class="n">plot_dist</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_to</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.simulate_on_byo_doped_condition_from_exp_results" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Simulate k-seq count dataset based on the experimental condition of BYO-doped pool, that</dt><dd><p>t: reaction time (90 min)
alpha: degradation ratio of BYO (0.479)
x_values: controlled BYO concentration points: 1 input pool with triple sequencing depth,</p>
<blockquote>
<div><dl class="simple">
<dt>5 BYO concentration with triplicates:</dt><dd><dl class="simple">
<dt>[-1 (input pool),</dt><dd><p>2e-6, 2e-6, 2e-6,
10e-6, 10e-6, 10e-6,
50e-6, 50e-6, 50e-6,
250e-6, 250e-6, 250e-6,
1260e-6, 1260e-6, 1260e-6]</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>Parameter for each sequences were sampled from previous point estimate results:</dt><dd><ul class="simple">
<li><p>point_est_csv: load point estimates results to extract estimated k and A</p></li>
<li><p>seqtable_path: path to load input sample SeqData object to get p0 information</p></li>
</ul>
</dd>
</dl>
<p>Returns:
x (pd.DataFrame): controlled variable (c, n) for samples</p>
<blockquote>
<div><p>Y (pd.DataFrame): simulated sequence counts for given samples
param_table (pd.DataFrame): seq_table list the parameters for simulated sequences, including p0, k, A, kA
truth (pd.DataFrame): true values of parameters (e.g. p0, k, A) for simulated sequences
seq_table (data.SeqData): a SeqData object to stores all the data</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="k_seq.data.simu.simulate_w_byo_doped_condition_from_param_dist">
<code class="sig-prename descclassname">k_seq.data.simu.</code><code class="sig-name descname">simulate_w_byo_doped_condition_from_param_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uniq_seq_num</span></em>, <em class="sig-param"><span class="n">depth</span></em>, <em class="sig-param"><span class="n">p0_loc</span></em>, <em class="sig-param"><span class="n">p0_scale</span></em>, <em class="sig-param"><span class="n">k_95</span></em>, <em class="sig-param"><span class="n">total_dna_error_rate</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">23</span></em>, <em class="sig-param"><span class="n">save_to</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot_dist</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#k_seq.data.simu.simulate_w_byo_doped_condition_from_param_dist" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Deprecated. Simulate k-seq count dataset similar to the experimental condition of BYO-doped pool, that</dt><dd><p>t: reaction time (90 min)
alpha: degradation ratio of BYO (0.479)
x_values: controlled BYO concentration points: 1 input pool with triple sequencing depth,</p>
<blockquote>
<div><dl class="simple">
<dt>5 BYO concentration with triplicates:</dt><dd><dl class="simple">
<dt>[-1 (input pool),</dt><dd><p>2e-6, 2e-6, 2e-6,
10e-6, 10e-6, 10e-6,
50e-6, 50e-6, 50e-6,
250e-6, 250e-6, 250e-6,
1260e-6, 1260e-6, 1260e-6]</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>Parameter for each sequences were sampled from given distribution defined from arguments</dt><dd><ul class="simple">
<li><p>p0: log normal from exp(N(p0_loc, p0_scale))</p></li>
<li><p>k: log normal from k_95 95-percentile for k</p></li>
<li><p>A: uniform from [0, 1]</p></li>
</ul>
</dd>
</dl>
<p>Other args:
uniq_seq_num (int): Number of unique sequences from simulation</p>
<blockquote>
<div><p>depth (int or float): sequence depth defined on mean reads per sequence
total_amount_error (float or callable): float as the standard deviation for a fixed Gaussian error, or any error function on the DNA amount. Use 0 for no introduced error.
save_to (str): optional, path to save the simulation results with x, Y, truth csv file and a pickled SeqData object
plot_dist (bool): if pairwise figures of distribution for simulated parameters (p0, A, k, kA)</p>
</div></blockquote>
<p>Returns:
x (pd.DataFrame): controlled variable (c, n) for samples</p>
<blockquote>
<div><p>Y (pd.DataFrame): simulated sequence counts for given samples
param_table (pd.DataFrame): seq_table list the parameters for simulated sequences, including p0, k, A, kA
truth (pd.DataFrame): true values of parameters (e.g. p0, k, A) for simulated sequences
seq_table (data.SeqData): a SeqData object to stores all the data</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="k-seq-data-visualzation-module">
<h2>k_seq.data.visualzation module<a class="headerlink" href="#k-seq-data-visualzation-module" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="k_seq.model.html" class="btn btn-neutral float-right" title="k_seq.model: kinetics and pool models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="k-seq_package.html" class="btn btn-neutral float-left" title="k-seq package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Yuning Shen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>